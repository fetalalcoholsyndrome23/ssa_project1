{% extends 'chipin/base.html' %}
{% block title %}{{ group.name }}{% endblock %}
{% block content %}
    <style>
        /* Import a Google Font */
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

        body {
            background-color: #f2dbb7;
            font-family: 'Parkinsans', sans-serif; /* Applying Roboto font to the entire body */
        }

        h2 {
            font-family: 'Roboto', sans-serif;
            font-weight: 700; /* Bold style */
        }

        p, a {
            font-family: 'Roboto', sans-serif;
            font-weight: 400; /* Regular style */
        }
    </style>
   <h1>{{ group.name }}</h1>
   <p>Administrator: {{ group.admin.profile.nickname }}</p>
   
   {% if messages %}
     <div class="messages">
       {% for message in messages %}
         <div class="alert alert-{{ message.tags }}">{{ message }}</div>
       {% endfor %}
     </div>
   {% endif %}
   
   <h2>Events</h2>
   {% for event in group.events.all %}
     <div class="event {% if event.is_archived %}archived{% endif %}">
       <h3>{{ event.name }}</h3>
       <span class="event-status">{{ event.status }}</span>
       
       {% if not event.is_archived %}
         {% if request.user == group.admin %}
           <a href="{% url 'transfer_funds' event.id %}" onclick="return confirm('Are you sure you want to transfer funds?')" class="btn btn-primary">Transfer Funds</a>
           <a href="{% url 'delete_event' event.id %}" onclick="return confirm('Are you sure you want to delete this event?')" class="btn btn-danger">Delete Event</a>
         {% endif %}
         
         {% if request.user in group.members.all and request.user not in event.participants.all and user_balance >= event.contribution_amount %}
           <a href="{% url 'join_event' event.id %}" class="btn btn-success">Join Event</a>
         {% endif %}
         
         {% if request.user in event.participants.all %}
           <a href="{% url 'leave_event' event.id %}" class="btn btn-warning">Leave Event</a>
         {% endif %}
       {% endif %}
     </div>
   {% endfor %}
   
   <h2>Comments</h2>
   {% for comment in comments %}
     <div class="comment">
       <p>{{ comment.user.profile.nickname }}: {{ comment.content }}</p>
       <small>Posted on {{ comment.created_at }}</small>
       {% if comment.user == request.user or request.user == group.admin %}
         <a href="{% url 'edit_comment' comment.id %}">Edit</a>
         <a href="{% url 'delete_comment' comment.id %}">Delete</a>
       {% endif %}
     </div>
   {% empty %}
     <p>No comments yet. Be the first to comment!</p>
   {% endfor %}
   
   <h2>{% if comment_to_edit %}Edit Comment{% else %}Add a comment{% endif %}</h2>
   <!-- Add your comment form here -->
   
   <h2>Members</h2>
   <ul class="member-list">
     {% for member in group.members.all %}
       <li>{{ member.profile.nickname }}</li>
     {% endfor %}
   </ul>
   
   {% if request.user not in group.members.all %}
     <a href="{% url 'request_to_join' group.id %}" class="btn btn-primary">Request to Join</a>
   {% endif %}
   
   {% if request.user == group.admin %}
     <h2>Join Requests</h2>
     <ul class="join-requests">
       {% for join_request in group.join_requests.all %}
         <li>
           {{ join_request.user.username }} has requested to join.
           <a href="{% url 'approve_request' join_request.id %}" class="btn btn-success">Approve</a>
           <a href="{% url 'reject_request' join_request.id %}" class="btn btn-danger">Reject</a>
         </li>
       {% empty %}
         <li>No pending join requests.</li>
       {% endfor %}
     </ul>
   {% endif %}
{% endblock content %}